import pandas as pd

# Your existing code
dataset['Hazard_Classification'] = dataset['Is_Potentially_Hazardous'].map({True: 'Dangerous', False: 'Not Dangerous'})
dataset = dataset[dataset['Is_Potentially_Hazardous'] == True]  # Remove this if you want all asteroids
dataset['Diameter_Max_KM'] = dataset['Diameter_Max_KM'].astype(float)
dataset.sort_values(by='Diameter_Max_KM', ascending=False, inplace=True)

# Add ranking based on Diameter_Max_KM
dataset['Diameter_Rank'] = dataset['Diameter_Max_KM'].rank(method='dense', ascending=False)

# If you want integer ranks without decimals, you can convert to int
dataset['Diameter_Rank'] = dataset['Diameter_Rank'].astype(int)

# Reset index if you want the row numbers to reflect the new order
dataset.reset_index(drop=True, inplace=True)
